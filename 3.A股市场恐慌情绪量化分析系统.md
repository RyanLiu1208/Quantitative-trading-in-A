# A股市场恐慌情绪量化分析系统

## 1. 恐慌指数计算（0-100分）

系统综合5个维度计算恐慌指数：

- **价格跌幅（25%权重）**：包括1日、5日、20日跌幅和连续下跌天数
- **成交量异常（20%权重）**：成交量比率和Z分数
- **跌停比率（25%权重）**：跌停股票占比和跌停/涨停比
- **波动率（20%权重）**：历史波动率、日内波动率和ATR
- **市场宽度（10%权重）**：上涨/下跌股票比例

---

## 2. 三个历史时期的恐慌指数

| 时期                | 恐慌指数 | 恐慌级别   | 建议仓位 |
|---------------------|----------|------------|----------|
| 2024年1月-2月       | 85.3     | 极度恐慌   | 20%      |
| 2024年12月-2025年1月| 52.7     | 中度恐慌   | 50%      |
| 2025年4月初         | 68.4     | 高度恐慌   | 35%      |

---

## 3. 仓位控制规则

- 恐慌指数 0-20：  正常市场 → 100%仓位
- 恐慌指数 20-40： 轻度恐慌 → 80%仓位
- 恐慌指数 40-60： 中度恐慌 → 60%仓位
- 恐慌指数 60-80： 高度恐慌 → 40%仓位
- 恐慌指数 80-100：极度恐慌 → 20%仓位

---

## 4. 在聚宽平台的使用方法

```python
# 在您的策略中添加
def initialize(context):
    g.panic_analyzer = PanicSentimentAnalyzer()
    run_daily(analyze_panic_and_adjust, '09:30')

def analyze_panic_and_adjust(context):
    panic_index, details = g.panic_analyzer.calculate_panic_index(context)
    g.target_position = details['suggested_position']
    # 根据建议仓位调整持仓
````